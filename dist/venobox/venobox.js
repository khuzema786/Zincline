!function(d){var c,s,v,f,m,b,h,u,g,y,p,x,t,w,k,C,j,q,z,H,a,e,D,E;function L(){d.ajax({url:h,cache:!1}).done(function(t){b.html('<div class="vbox-inline">'+t+"</div>"),o()}).fail(function(){b.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>'),o()})}function P(){b.html('<iframe class="venoframe" src="'+h+'"></iframe>'),o()}function Q(t){var a=h.split("/"),a=a[a.length-1];b.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen frameborder="0" src="//player.vimeo.com/video/'+a+(t?"?autoplay=1":"")+'"></iframe>'),o()}function X(t){var a=h.split("/"),a=a[a.length-1];b.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen src="//www.youtube.com/embed/'+a+(t?"?autoplay=1":"")+'"></iframe>'),o()}function A(){b.html('<div class="vbox-inline">'+d(h).html()+"</div>"),o()}function B(){d(".vbox-content").find("img").one("load",function(){o()}).each(function(){this.complete&&d(this).load()})}function o(){f.html(j),b.find(">:first-child").addClass("figlio"),d(".figlio").css("width",g).css("height",y).css("padding",m).css("background",s),e=b.outerHeight(),a=d(window).height(),e+80<a?(t=(a-e)/2,b.css("margin-top",t),b.css("margin-bottom",t)):(b.css("margin-top","40px"),b.css("margin-bottom","40px")),b.animate({opacity:"1"},"slow")}d.fn.extend({venobox:function(t){var r=d.extend({framewidth:"",frameheight:"",border:"0",bgcolor:"#fff",titleattr:"title",numeratio:!1,infinigall:!1,overlayclose:!0},t);return this.each(function(){var l=d(this);if(l.data("venobox"))return!0;l.addClass("vbox-item"),l.data("framewidth",r.framewidth),l.data("frameheight",r.frameheight),l.data("border",r.border),l.data("bgcolor",r.bgcolor),l.data("numeratio",r.numeratio),l.data("infinigall",r.infinigall),l.data("overlayclose",r.overlayclose),l.data("venobox",!0),l.click(function(t){function a(){q=l.data("gall"),w=l.data("numeratio"),p=l.data("infinigall"),1<(q=d('.vbox-item[data-gall="'+q+'"]')).length&&!0===w?(v.html(q.index(l)+1+" / "+q.length),v.show()):v.hide(),z=q.eq(q.index(l)+1),H=q.eq(q.index(l)-1),l.attr(r.titleattr)?(j=l.attr(r.titleattr),f.show()):(j="",f.hide()),1<q.length&&!0===p?(E=D=!0,z.length<1&&(z=q.eq(0)),q.index(l)<1&&(H=q.eq(q.index(q.length)))):(D=0<z.length?(d(".vbox-next").css("display","block"),!0):(d(".vbox-next").css("display","none"),!1),E=0<q.index(l)?(d(".vbox-prev").css("display","block"),!0):(d(".vbox-prev").css("display","none"),!1))}t.stopPropagation(),t.preventDefault(),l=d(this),k=l.data("overlay"),g=l.data("framewidth"),y=l.data("frameheight"),c=l.data("autoplay")||!1,m=l.data("border"),s=l.data("bgcolor"),x=E=D=!1,h=l.data("href")||l.attr("href"),u=l.data("css")||"",d("body").addClass("vbox-open"),u='<div class="vbox-overlay '+u+'" style="background:'+k+'"><div class="vbox-preloader">Loading...</div><div class="vbox-container"><div class="vbox-content"></div></div><div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">X</div><div class="vbox-next">next</div><div class="vbox-prev">prev</div></div>',d("body").append(u),C=d(".vbox-overlay"),d(".vbox-container"),b=d(".vbox-content"),v=d(".vbox-num"),f=d(".vbox-title"),b.html(""),b.css("opacity","0"),a(),C.css("min-height",d(window).outerHeight()),C.animate({opacity:1},250,function(){"iframe"==l.data("type")?P():"inline"==l.data("type")?A():"ajax"==l.data("type")?L():"vimeo"==l.data("type")?Q(c):"youtube"==l.data("type")?X(c):(b.html('<img src="'+h+'">'),B())});var e=function(){x||(x=!0,k=H.data("overlay"),g=H.data("framewidth"),y=H.data("frameheight"),m=H.data("border"),s=H.data("bgcolor"),h=H.data("href")||H.attr("href"),c=H.data("autoplay"),j=H.attr(r.titleattr)?H.attr(r.titleattr):"",void 0===k&&(k=""),b.animate({opacity:0},500,function(){C.css("background",k),"iframe"==H.data("type")?P():"inline"==H.data("type")?A():"ajax"==H.data("type")?L():"youtube"==H.data("type")?X(c):"vimeo"==H.data("type")?Q(c):(b.html('<img src="'+h+'">'),B()),l=H,a(),x=!1}))},o=function(){x||(x=!0,k=z.data("overlay"),g=z.data("framewidth"),y=z.data("frameheight"),m=z.data("border"),s=z.data("bgcolor"),h=z.data("href")||z.attr("href"),c=z.data("autoplay"),j=z.attr(r.titleattr)?z.attr(r.titleattr):"",void 0===k&&(k=""),b.animate({opacity:0},500,function(){C.css("background",k),"iframe"==z.data("type")?P():"inline"==z.data("type")?A():"ajax"==z.data("type")?L():"youtube"==z.data("type")?X(c):"vimeo"==z.data("type")?Q(c):(b.html('<img src="'+h+'">'),B()),l=z,a(),x=!1}))};function i(t){27===t.keyCode&&n()}function n(){d("body").removeClass("vbox-open"),d("body").unbind("keydown",i),C.animate({opacity:0},500,function(){C.remove(),x=!1,l.focus()})}d("body").keydown(function(t){37==t.keyCode&&1==E&&e(),39==t.keyCode&&1==D&&o()}),d(".vbox-prev").click(function(){e()}),d(".vbox-next").click(function(){o()});t=".vbox-close, .vbox-overlay";return l.data("overlayclose")||(t=".vbox-close"),d(t).click(function(t){d(t.target).is(".figlio")||d(t.target).is(".vbox-next")||d(t.target).is(".vbox-prev")||d(t.target).is(".figlio *")||n()}),d("body").keydown(i),!1})})}}),d(window).resize(function(){d(".vbox-content").length&&(e=b.height(),a=d(window).height(),e+80<a?(t=(a-e)/2,b.css("margin-top",t),b.css("margin-bottom",t)):(b.css("margin-top","40px"),b.css("margin-bottom","40px")))})}(jQuery);